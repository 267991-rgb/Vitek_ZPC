<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mini projekt — Mikrokontrolér</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header>
    <nav>
      <a href="index.html" class="btn primary">← Zpět na portfolio</a>
    </nav>
  </header>
  <main>
    <section class="blog-container">
      <h1 class="blog-post-title">Mini projekt realizovaný pomocí mikrokontroléru se vstupními a výstupními zařízeními</h1>
      <div class="blog-post-meta">
        <span>Publikováno: 31. 10. 2025</span>
        <span>Autor: Tomáš</span>
      </div>
      <div class="blog-tags">
        <a href="#" class="blog-tag">#mikrokontroler</a>
        <a href="#" class="blog-tag">#arduino</a>
        <a href="#" class="blog-tag">#radar</a>
      </div>
      <article class="blog-post">
        <div class="blog-post-content">
          <p>
            Jako elektro micro projekt jsem si dal za úkol sestrojit měřič vzdálenosti a rychlosti přiblížení a naměřené hodnoty zobrazit na display.
            Použil jsem ultrazvukový senzor HC-SR04, základní desku, display LCD 1602, 220 Ω odpor a potenciometr.
                  </p>
          <ul>
            <li>Měří v reálném čase</li>
            <li>Zobrazuje na display</li>
            <li>Přehledné uspořádání</li>
          </ul>
          <p>
            <strong>Technologie:</strong> Arduino, Tinkercad
             <br>
             <br>
                       Zde je obrázek zapojení v Tinkercadu.
          </p>
          <img src="tinkercad.png" alt="Mikrokontrolér projekt" />
          <p>
                        Tady je více zmatené zapojení na reálných součástkách.
          </p>
          <img src="zapojeni.JPEG" alt="Mikrokontrolér projekt" />
          Za zmínku by stálo říct to, že při zobrazování na display se hodnoty vypisovaly hned za dvojtečku a když se hodnota zvětšila o řád, celý zápis se musel posunout, a tak bylo extrémně těžké číst hodnoty při rychlé
          obnovovací frekvenci. Naopak při dlouhém času zápisu mezi hodnotami jsme nedostávali maximální efekt měření. Odsadil jsem tedy text na konec řádku a znaménko u rychlosti jsem nechal za dvojtečkou, aby nemuselo 
          měnit svoji pozici. Rychlost je zde počítána jako podíl rozdílu vzdáleností a delty času. 
           <p>
               <br>
            Zde přikládám kód:
             <br>
             <br>
#include &lt;LiquidCrystal.h&gt; <br>
// připojení LCD: RS, E, D4, D5, D6, D7<br>
LiquidCrystal lcd(12, 11, 10, 9, 8, 6);<br>
<br>
const int trigPin = 5;<br>
const int echoPin = 7;<br>
<br>
// proměnné pro výpočet<br>
long duration;<br>
float distance;        // aktuální vzdálenost v cm<br>
float prevDistance = 0;<br>
float speed = 0;       // rychlost v cm/s<br>
unsigned long prevTime = 0;<br>
<br>
void setup() {<br>
  Serial.begin(9600);<br>
  pinMode(trigPin, OUTPUT);<br>
  pinMode(echoPin, INPUT);<br>
<br>
  lcd.begin(16, 2);<br>
  lcd.print("Inicializace...");<br>
  delay(800);<br>
  lcd.clear();<br>
  prevTime = millis();<br>
}<br>
<br>
void loop() {<br>
  // měření vzdálenosti<br>
  digitalWrite(trigPin, LOW);<br>
  delayMicroseconds(2);<br>
  digitalWrite(trigPin, HIGH);<br>
  delayMicroseconds(10);<br>
  digitalWrite(trigPin, LOW);<br>
<br>
  duration = pulseIn(echoPin, HIGH, 25000); // timeout 25ms ~ 4m<br>
  if (duration > 0) {<br>
    distance = duration * 0.0343f / 2.0f;<br>
  } else {<br>
    distance = prevDistance; // při timeoutu držíme předchozí hodnotu<br>
  }<br>
<br>
  // výpočet rychlosti<br>
  unsigned long currentTime = millis();<br>
  float deltaTime = (currentTime - prevTime) / 1000.0f;<br>
<br>
  if (deltaTime > 0.0001f) {<br>
    speed = (prevDistance - distance) / deltaTime; // kladná = přibližuje se<br>
  } else {<br>
    speed = 0.0f;<br>
  }<br>
<br>
  // --- příprava formátovaných polí ---<br>
  char bufDist[10]; // 9 + '\0'<br>
  dtostrf((int)distance, 9, 0, bufDist); // vzdálenost jako celé číslo<br>
<br>
  char bufAbs[7];   // 6 znaků pro absolutní hodnotu<br>
  dtostrf((int)fabs(speed), 6, 0, bufAbs); // rychlost jako celé číslo<br>
<br>
  char bufNum[8];   // 7 znaků pro číslo + znaménko<br>
  for (int i = 0; i < 7; ++i) bufNum[i] = ' ';<br>
  bufNum[7] = '\0';<br>
<br>
  int lenNum = strlen(bufAbs);<br>
  int startPos = 6 - lenNum; // pozice čísla<br>
  if (startPos < 1) startPos = 1;<br>
  for (int i = 0; i < lenNum; ++i) bufNum[startPos + i] = bufAbs[i];<br>
<br>
  char sign = (speed >= 0.0f) ? '+' : '-';<br>
  int signPos = startPos - 1;<br>
  if (signPos < 0) signPos = 0;<br>
  bufNum[signPos] = sign;<br>
<br>
  // --- sestavení řádků pro LCD ---<br>
  char line1[17]; // 16 + '\0'<br>
  char line2[17];<br>
<br>
  snprintf(line1, sizeof(line1), "VZD: %9scm", bufDist);<br>
  snprintf(line2, sizeof(line2), "RYCH:%7scm/s", bufNum);<br>
<br>
  // --- výpis na LCD ---<br>
  lcd.setCursor(0, 0);<br>
  lcd.print(line1);<br>
  lcd.setCursor(0, 1);<br>
  lcd.print(line2);<br>
<br>
  // Debug do serialu<br>
  Serial.print("Vzdalenost: ");<br>
  Serial.print((int)distance);<br>
  Serial.print(" cm  |  Rychlost: ");<br>
  Serial.print((int)speed);<br>
  Serial.println(" cm/s");<br>
<br>
  // uložíme pro další iteraci<br>
  prevDistance = distance;<br>
  prevTime = currentTime;<br>
<br>
  delay(150); // 7x/s<br>
}<br>
          </p>
              </div>
      </article>
      <p>
        <a href="index.html" class="btn primary">← Zpět na hlavní stránku</a>
      </p>
    </section>
  </main>
</body>
</html>






